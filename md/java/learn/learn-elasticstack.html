<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Elasticstack | 私人知识图书馆</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="包含: Java 基础, Java 部分源码, JVM, Spring, Spring Boot, Spring Cloud, 数据库原理, MySQL, ElasticSearch, MongoDB, Docker, k8s, CI&amp;CD, Linux, DevOps, 分布式, 中间件, 开发工具, Git, IDE, 源码阅读，读书笔记, 开源项目...">
    <meta name="robots" content="all">
    <meta name="author" content="pdai">
    <meta name="keywords" content="私人知识图书馆, java体系, java知识体系, java框架,java详解,java学习路线,java spring, java面试, 知识体系, java技术体系, java编程, java编程指南,java开发体系, java开发,java教程,java,java数据结构, 算法, 开发基础">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/assets/css/0.styles.cb877f3d.css" as="style"><link rel="preload" href="/assets/js/app.1f563e48.js" as="script"><link rel="preload" href="/assets/js/3.53f669bd.js" as="script"><link rel="preload" href="/assets/js/4.498eb10c.js" as="script"><link rel="prefetch" href="/assets/js/10.676c5100.js"><link rel="prefetch" href="/assets/js/11.9df653b2.js"><link rel="prefetch" href="/assets/js/12.b17e6356.js"><link rel="prefetch" href="/assets/js/13.ed90e22e.js"><link rel="prefetch" href="/assets/js/14.61f9cd6f.js"><link rel="prefetch" href="/assets/js/15.ac0ef010.js"><link rel="prefetch" href="/assets/js/16.3e29f439.js"><link rel="prefetch" href="/assets/js/17.90c09287.js"><link rel="prefetch" href="/assets/js/18.5e9ee40a.js"><link rel="prefetch" href="/assets/js/19.f113b0b6.js"><link rel="prefetch" href="/assets/js/2.a4f6f631.js"><link rel="prefetch" href="/assets/js/20.708a3e23.js"><link rel="prefetch" href="/assets/js/21.3a0dc559.js"><link rel="prefetch" href="/assets/js/22.72642347.js"><link rel="prefetch" href="/assets/js/5.ee589329.js"><link rel="prefetch" href="/assets/js/6.4e969a30.js"><link rel="prefetch" href="/assets/js/7.1153cd27.js"><link rel="prefetch" href="/assets/js/8.cb8ac540.js"><link rel="prefetch" href="/assets/js/9.5e517e4f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cb877f3d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/favicon.ico" alt="私人知识图书馆" class="logo"> <span class="site-name can-hide">私人知识图书馆</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  概述
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><span class="title">学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习笔记" class="mobile-dropdown-title"><span class="title">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/learn-typescript.html" class="nav-link">
  Typescript
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/ChromeExtensions.html" class="nav-link">
  ChromeExtensions
</a></li></ul></li><li class="dropdown-item"><h4>
          Java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/Java8-Stream.html" class="nav-link">
  Stream
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Java8-Optional.html" class="nav-link">
  Optional
</a></li></ul></li><li class="dropdown-item"><h4>
          框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/Spring笔记.html" class="nav-link">
  Spring笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Spring-MVC笔记.html" class="nav-link">
  SpringMVC笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Mybatis笔记.html" class="nav-link">
  Mybatis笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Maven学习笔记.html" class="nav-link">
  Maven学习笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/learn-zookeeper.html" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/learn-redis.html" class="nav-link">
  Redis
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/learn-elasticstack.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Elasticstack
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Dubbo学习笔记.html" class="nav-link">
  Dubbo学习笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具|部署" class="dropdown-title"><span class="title">工具|部署</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具|部署" class="mobile-dropdown-title"><span class="title">工具|部署</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/java/tool/git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/md/java/tool/gittool.html" class="nav-link">
  Gitee
</a></li></ul></div></div><div class="nav-item"><a href="/md/about/about-me.html" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/amzpiper" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  概述
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><span class="title">学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习笔记" class="mobile-dropdown-title"><span class="title">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/learn-typescript.html" class="nav-link">
  Typescript
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/ChromeExtensions.html" class="nav-link">
  ChromeExtensions
</a></li></ul></li><li class="dropdown-item"><h4>
          Java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/Java8-Stream.html" class="nav-link">
  Stream
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Java8-Optional.html" class="nav-link">
  Optional
</a></li></ul></li><li class="dropdown-item"><h4>
          框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/java/learn/Spring笔记.html" class="nav-link">
  Spring笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Spring-MVC笔记.html" class="nav-link">
  SpringMVC笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Mybatis笔记.html" class="nav-link">
  Mybatis笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Maven学习笔记.html" class="nav-link">
  Maven学习笔记
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/learn-zookeeper.html" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/learn-redis.html" class="nav-link">
  Redis
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/learn-elasticstack.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Elasticstack
</a></li><li class="dropdown-subitem"><a href="/md/java/learn/Dubbo学习笔记.html" class="nav-link">
  Dubbo学习笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具|部署" class="dropdown-title"><span class="title">工具|部署</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具|部署" class="mobile-dropdown-title"><span class="title">工具|部署</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/java/tool/git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/md/java/tool/gittool.html" class="nav-link">
  Gitee
</a></li></ul></div></div><div class="nav-item"><a href="/md/about/about-me.html" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/amzpiper" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/learn/learn-typescript.html" class="sidebar-link">TypeScript</a></li><li><a href="/md/java/learn/ChromeExtensions.html" class="sidebar-link">Chrome Extensions</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/learn/Java8-Stream.html" class="sidebar-link">Java 8 - Stream</a></li><li><a href="/md/java/learn/Java8-Optional.html" class="sidebar-link">Java 8 - Optional</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/java/learn/Spring笔记.html" class="sidebar-link">Spring</a></li><li><a href="/md/java/learn/Spring-MVC笔记.html" class="sidebar-link">SpringMVC</a></li><li><a href="/md/java/learn/Mybatis笔记.html" class="sidebar-link">Mybatis</a></li><li><a href="/md/java/learn/Maven学习笔记.html" class="sidebar-link">Maven</a></li><li><a href="/md/java/learn/learn-zookeeper.html" class="sidebar-link">Zookeeper</a></li><li><a href="/md/java/learn/learn-redis.html" class="sidebar-link">Redis</a></li><li><a href="/md/java/learn/learn-elasticstack.html" aria-current="page" class="active sidebar-link">Elasticstack</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/md/java/learn/learn-elasticstack.html#_1-elasticsearch产品简介" class="sidebar-link">1.Elasticsearch产品简介</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/learn-elasticstack.html#_2-elasticsearch与kibana入门" class="sidebar-link">2.Elasticsearch与Kibana入门</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/learn-elasticstack.html#_3-beats入门" class="sidebar-link">3.Beats入门</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/learn-elasticstack.html#_4-logstach入门" class="sidebar-link">4.Logstach入门</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/learn-elasticstack.html#_5-实战-分析elasticsearch查询语句" class="sidebar-link">5.实战：分析Elasticsearch查询语句</a></li><li class="sidebar-sub-header"><a href="/md/java/learn/learn-elasticstack.html#_6-总结与建议" class="sidebar-link">6.总结与建议</a></li></ul></li><li><a href="/md/java/learn/Dubbo学习笔记.html" class="sidebar-link">Dubbo</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="elasticsearch"><a href="#elasticsearch" class="header-anchor">#</a> Elasticsearch</h1> <h2 id="_1-elasticsearch产品简介"><a href="#_1-elasticsearch产品简介" class="header-anchor">#</a> 1.Elasticsearch产品简介</h2> <p><a href="https://www.elastic.co/cn/elastic-stack/" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/elastic-stack/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/assets/img/Untitled.12645b35.png" alt="Untitled.png"></p> <p>文档：<a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_2-elasticsearch与kibana入门"><a href="#_2-elasticsearch与kibana入门" class="header-anchor">#</a> 2.Elasticsearch与Kibana入门</h2> <h3 id="_2-1-安装与运行"><a href="#_2-1-安装与运行" class="header-anchor">#</a> 2.1.安装与运行</h3> <h4 id="_2-1-1-安装jdk1-8"><a href="#_2-1-1-安装jdk1-8" class="header-anchor">#</a> 2.1.1.安装JDK1.8</h4> <h4 id="_2-1-2-下载安装elasticsearch"><a href="#_2-1-2-下载安装elasticsearch" class="header-anchor">#</a> 2.1.2.下载安装Elasticsearch</h4> <p><a href="https://www.elastic.co/cn/" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.elastic.co/cn/elastic-stack/" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/elastic-stack/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.elastic.co/cn/elasticsearch/" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/elasticsearch/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/assets/img/Untitled1.d0dacd1e.png" alt="Untitled1.png"></p> <p><a href="http://localhost:9200/" target="_blank" rel="noopener noreferrer">http://localhost:9200/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="_2-1-3-配置elasticsearch"><a href="#_2-1-3-配置elasticsearch" class="header-anchor">#</a> 2.1.3.配置Elasticsearch</h4> <p><img src="/assets/img/Untitled2.9f6de3ab.png" alt="Untitled2.png"></p> <p>配置启动时JVM参数:</p> <p>-Xms2g</p> <p>-Xms2g</p> <p><img src="/assets/img/Untitled3.07da7b46.png" alt="Untitled3.png"></p> <p>运行有两种模式：</p> <p><img src="/assets/img/Untitled4.64e801a9.png" alt="Untitled4.png"></p> <h4 id="_2-1-4-配置启动elasticsearch集群"><a href="#_2-1-4-配置启动elasticsearch集群" class="header-anchor">#</a> 2.1.4.配置启动Elasticsearch集群</h4> <p><img src="/assets/img/Untitled5.13a5f74f.png" alt="Untitled5.png"></p> <p>./elasticsearch.bat</p> <p>./elasticsearch.bat -Ehttp.port=8200 -Epath.data=node2</p> <p>./elasticsearch.bat -Ehttp.port=7200 -Epath.data=node3</p> <p><a href="http://localhost:9200/_cat/nodes?v" target="_blank" rel="noopener noreferrer">http://localhost:9200/_cat/nodes?v<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://localhost:9200/_cat/nodes?v" target="_blank" rel="noopener noreferrer">http://localhost:9200/_cat/nodes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>*为主节点</p> <p><a href="http://localhost:9200/_cat/nodes?v" target="_blank" rel="noopener noreferrer">http://localhost:9200/_<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>cluster/stats</p> <h4 id="_2-1-5-kibana安装与运行"><a href="#_2-1-5-kibana安装与运行" class="header-anchor">#</a> 2.1.5.Kibana安装与运行</h4> <p><a href="https://www.elastic.co/cn/kibana/" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/kibana/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.elastic.co/cn/downloads/kibana" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/downloads/kibana<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/assets/img/Untitled6.3eb8010b.png" alt="Untitled6.png"></p> <h4 id="_2-1-6-kibana配置"><a href="#_2-1-6-kibana配置" class="header-anchor">#</a> 2.1.6.Kibana配置</h4> <p><img src="/assets/img/Untitled7.f791d59a.png" alt="Untitled7.png"></p> <h4 id="_2-1-7-kibana常用功能"><a href="#_2-1-7-kibana常用功能" class="header-anchor">#</a> 2.1.7.Kibana常用功能</h4> <p><img src="/assets/img/Untitled8.191dbd16.png" alt="Untitled8.png"></p> <h4 id="_2-1-8-elasticsearch常用术语"><a href="#_2-1-8-elasticsearch常用术语" class="header-anchor">#</a> 2.1.8.Elasticsearch常用术语</h4> <p>Document文档数据</p> <p>Index索引，理解成Mysql的数据库,Document都存储在Index中</p> <p>Type索引中的数据类型，为myslq表的数据类型，简单理解为table</p> <p>Field字段，文档的属性</p> <p>Query DSL查询语法</p> <h4 id="_2-1-9-elasticsearch-crud操作"><a href="#_2-1-9-elasticsearch-crud操作" class="header-anchor">#</a> 2.1.9.Elasticsearch CRUD操作</h4> <p><strong>创建：</strong></p> <p><img src="/assets/img/Untitled9.38ef54c3.png" alt="Untitled9.png"></p> <p>accounts 为Index，person为Type</p> <p>我们在accounts 这个Index的下面person为Type的下面创建1个id为1的文档.name...等都是文档字段。</p> <p>使用Kibana的Dev Tools运行。</p> <p><img src="/assets/img/Untitled10.479b764d.png" alt="Untitled10.png"></p> <p><strong>读取：</strong></p> <p><img src="/assets/img/Untitled11.7be95cfe.png" alt="Untitled11.png"></p> <p><img src="/assets/img/Untitled12.204c700d.png" alt="Untitled12.png"></p> <p><strong>修改：</strong></p> <p><img src="/assets/img/Untitled13.af31113f.png" alt="Untitled13.png"></p> <p><img src="/assets/img/Untitled14.7404f27a.png" alt="Untitled14.png"></p> <p><strong>删除：</strong></p> <p><img src="/assets/img/Untitled15.6390151b.png" alt="Untitled15.png"></p> <p><img src="/assets/img/Untitled16.631797a4.png" alt="Untitled16.png"></p> <h4 id="_2-1-10-elasticsearch-查询操作"><a href="#_2-1-10-elasticsearch-查询操作" class="header-anchor">#</a> 2.1.10.Elasticsearch 查询操作</h4> <p><strong>有2种形势:</strong></p> <ol><li>Query String:</li></ol> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token constant">GET</span> <span class="token operator">/</span>accounts<span class="token operator">/</span>person<span class="token operator">/</span>_search<span class="token operator">?</span>q<span class="token operator">=</span><span class="token number">1</span>

<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">989</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;accounts&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;person&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;yuhang&quot;</span><span class="token punctuation">,</span>
          <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><ol start="2"><li>Query DSL:</li></ol> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token constant">GET</span> <span class="token operator">/</span>accounts<span class="token operator">/</span>person<span class="token operator">/</span>_search
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;yuhang&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">997</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">0.18232156</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;accounts&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;person&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token number">0.18232156</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;yuhang&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;accounts&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;person&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token number">0.18232156</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;yuhang&quot;</span><span class="token punctuation">,</span>
          <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h2 id="_3-beats入门"><a href="#_3-beats入门" class="header-anchor">#</a> 3.Beats入门</h2> <h3 id="_3-1-beats简介"><a href="#_3-1-beats简介" class="header-anchor">#</a> 3.1.Beats简介</h3> <p>Beats 是一个免费且开放的平台，集合了多种单一用途数据采集器。它们从成百上千或成千上万台机器和系统向 Logstash 或 Elasticsearch 发送数据。</p> <p><a href="https://www.elastic.co/cn/beats/" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/beats/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>产品系列：</p> <p><img src="/assets/img/Untitled17.a3614fcc.png" alt="Untitled17.png"></p> <p>FILEBEAT：无论您是从安全设备、云、容器、主机还是 OT 进行数据收集，Filebeat 都将为您提供一种轻量型方法，用于转发和汇总日志与文件，让简单的事情不再繁杂。</p> <p>METRICBEAT：用于从系统和服务收集指标。Metricbeat 能够以一种轻量型的方式，输送各种系统和服务统计数据，从 CPU 到内存，从 Redis 到 Nginx，不一而足。</p> <p>PACKETBEAT：监测网络流量对于获得可观测性和保护环境至关重要，有助于确保高水平的性能和安全性。Packetbeat 是一款轻量型网络数据包分析器，能够将主机和容器中的数据发送至 Logstash 或 Elasticsearch。抓包分析服务器网络。</p> <p>WINLOGBEAT：用于密切监控基于 Windows 的基础设施上发生的事件。使用 Winlogbeat，将 Windows 事件日志流式传输至 Elasticsearch 和 Logstash。</p> <p>HEARTBEAT：通过主动探测来监测服务的可用性。通过给定 URL 列表，Heartbeat 仅仅询问：网站运行正常吗？Heartbeat 会将此信息和响应时间发送至 Elastic 的其他部分，以进行进一步分析。健康检查。</p> <p>地位：</p> <p><img src="/assets/img/Untitled18.3aea0563.png" alt="Untitled18.png"></p> <p>Beats把所有数据直接传输给elasticsearch，或者传输给logstash处理转换后再传入elasticsearch。最后通过kibana做可视化展示。</p> <h3 id="_3-2-filebeat简介"><a href="#_3-2-filebeat简介" class="header-anchor">#</a> 3.2.Filebeat简介</h3> <p>filebeat 不需要知道 master 节点，你给 filebeat 的是 data 节点地址即可，不必给 master 节点地址</p> <h4 id="_3-2-1-处理流程"><a href="#_3-2-1-处理流程" class="header-anchor">#</a> 3.2.1.处理流程</h4> <ul><li>输入Input</li> <li>处理Filter</li> <li>输出Output</li></ul> <h4 id="_3-2-2-构成"><a href="#_3-2-2-构成" class="header-anchor">#</a> 3.2.2.构成</h4> <p><img src="/assets/img/Untitled19.4c8a57e9.png" alt="Untitled19.png"></p> <p><strong>Prospector:</strong></p> <p>针对配置的日志文件探测文件是否有变化，有变化就收集新的日志。1个Filebeat可以有多个Prospector。Prospector 1针对/var/log/*.log所有log文件。Prospector 2针对/var/log/apache2/*下的所有文件。</p> <p><strong>Harvester:</strong></p> <p>每个Prospector针对自己匹配的日志文件会为每一个日志文件启动1个Harvester。</p> <h4 id="_3-2-2-filebeat-input配置"><a href="#_3-2-2-filebeat-input配置" class="header-anchor">#</a> 3.2.2.Filebeat Input配置</h4> <p>yaml语法：</p> <p><img src="/assets/img/Untitled20.9f4f372e.png" alt="Untitled20.png"></p> <p>input_type为数据输入类型，目前有2个类型：log、stdin</p> <p>paths是指定位置</p> <h4 id="_3-2-3-filebeat-output配置"><a href="#_3-2-3-filebeat-output配置" class="header-anchor">#</a> 3.2.3.Filebeat Output配置</h4> <p><strong>支持输出对象类型：</strong></p> <ul><li>console</li> <li>elasticsearch</li> <li>logstach</li> <li>kafka</li> <li>redis</li> <li>file</li></ul> <p>配置为elasticsearch和console：</p> <p><img src="/assets/img/Untitled21.c5916451.png" alt="Untitled21.png"></p> <h4 id="_3-2-4-filebeat-filter配置简介"><a href="#_3-2-4-filebeat-filter配置简介" class="header-anchor">#</a> 3.2.4.Filebeat Filter配置简介</h4> <p><img src="/assets/img/Untitled22.d4a0d43a.png" alt="Untitled22.png"></p> <p>Include_lines:当达到这个条件就读入这一行。</p> <p>exclude_lines:当达到这个条件就不读这一行。</p> <p>exclude_files:当达到这个条件就不读这文件。</p> <p>drop_event:当满足这一条件就不输出，直接扔掉</p> <p>drop_fields:当满足这一条件就不输出，把某一字段扔掉</p> <p>drop_event:当满足这一条件就不输出，直接扔掉</p> <p>drop_event:当满足这一条件就不输出，直接扔掉</p> <p>Decode_json_fields:对于这条数据里面符合json格式的字段做json解析</p> <p>Include_fields:加入一些字段或只想取数据里面的某一些字段</p> <p>例子：</p> <p>1.当DBG开头的就丢掉，把debbug日志丢弃</p> <p><img src="/assets/img/Untitled23.9e9d122a.png" alt="Untitled23.png"></p> <p>2.inner后数据是字符串需要做json处理，恢复正常json格式</p> <p><img src="/assets/img/Untitled24.4009fb2e.png" alt="Untitled24.png"></p> <p>新特性：</p> <p><img src="/assets/img/Untitled25.75258fe0.png" alt="Untitled25.png"></p> <h4 id="_3-2-5-filebeat-module简介"><a href="#_3-2-5-filebeat-module简介" class="header-anchor">#</a> 3.2.5.Filebeat Module简介</h4> <p><img src="/assets/img/Untitled26.f4a94f14.png" alt="Untitled26.png"></p> <h4 id="_3-2-6-filebeat-收集nginx日志实践"><a href="#_3-2-6-filebeat-收集nginx日志实践" class="header-anchor">#</a> 3.2.6.Filebeat 收集Nginx日志实践</h4> <p>通过stdin收集日志，通过console输出</p> <p>1.下载Filebeat</p> <p><a href="https://www.elastic.co/cn/downloads/beats/filebeat" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/downloads/beats/filebeat<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.elastic.co/cn/downloads/beats/filebeat" target="_blank" rel="noopener noreferrer">filebeat<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是基于go-lang开发的</p> <p>2.配置filebeat.yml</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code># <span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span> Filebeat inputs <span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">=</span>

filebeat<span class="token punctuation">.</span>inputs<span class="token operator">:</span>

# Each <span class="token operator">-</span> is an input<span class="token punctuation">.</span> Most options can be <span class="token keyword">set</span> at the input level<span class="token punctuation">,</span> so
# you can use different inputs <span class="token keyword">for</span> various configurations<span class="token punctuation">.</span>
# Below are the input specific configurations<span class="token punctuation">.</span>

<span class="token operator">-</span> type<span class="token operator">:</span> log

  # Change to <span class="token boolean">true</span> to enable <span class="token keyword">this</span> input configuration<span class="token punctuation">.</span>
  <span class="token literal-property property">enabled</span><span class="token operator">:</span> <span class="token boolean">true</span>

  # Paths that should be crawled and fetched<span class="token punctuation">.</span> Glob based paths<span class="token punctuation">.</span>
  <span class="token literal-property property">paths</span><span class="token operator">:</span>
    #<span class="token operator">-</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token comment">/*.log
    #- c:\programdata\elasticsearch\logs\*
    - D:\Application\elasticsearch-7.14.0\logs\elasticsearch.log

# ------------------------------- Console Output -------------------------------
output.console:
  # Boolean flag to enable or disable the output module.
  enabled: true

  # Configure JSON encoding
  codec.json:
    # Pretty-print JSON event
    pretty: true

    # Configure escaping HTML symbols in strings.
    #escape_html: false
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="_3-3-packetbeat简介"><a href="#_3-3-packetbeat简介" class="header-anchor">#</a> 3.3.Packetbeat简介</h3> <p><img src="/assets/img/Untitled27.2c4bbcb2.png" alt="Untitled27.png"></p> <p><img src="/assets/img/Untitled28.a455abe2.png" alt="Untitled28.png"></p> <p><img src="/assets/img/Untitled29.9f13f006.png" alt="Untitled29.png"></p> <p>-strict.perms=false不检查权限，方便运行</p> <h2 id="_4-logstach入门"><a href="#_4-logstach入门" class="header-anchor">#</a> 4.Logstach入门</h2> <h3 id="_4-1-logstach简介"><a href="#_4-1-logstach简介" class="header-anchor">#</a> 4.1.Logstach简介</h3> <p>Data Shipper,ETL,Extract,Transform,Load</p> <p><a href="https://www.elastic.co/cn/logstash/" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/logstash/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>集中、转换和存储数据</p> <p>Logstash 是免费且开放的服务器端数据处理管道，能够从多个来源采集数据，转换数据，然后将数据发送到您最喜欢的“存储库”中。</p> <h3 id="_4-2-logstach处理流程"><a href="#_4-2-logstach处理流程" class="header-anchor">#</a> 4.2.Logstach处理流程</h3> <p>Input：file、redis、beats、kafka</p> <p>Filter：grok(表达式，类似正则)、mutate(结构化后数据增删改查)、drop、date</p> <p>Output：stdout、elasticsearch、kakfa、redis</p> <h3 id="_4-3-logstach配置"><a href="#_4-3-logstach配置" class="header-anchor">#</a> 4.3.Logstach配置</h3> <h4 id="_4-3-1-处理流程-input和output配置"><a href="#_4-3-1-处理流程-input和output配置" class="header-anchor">#</a> 4.3.1.处理流程—input和output配置</h4> <p><img src="/assets/img/Untitled30.a914264e.png" alt="Untitled30.png"></p> <h4 id="_4-3-2-处理流程-filter配置"><a href="#_4-3-2-处理流程-filter配置" class="header-anchor">#</a> 4.3.2.处理流程—Filter配置</h4> <p><img src="/assets/img/Untitled31.ef5a4edb.png" alt="Untitled31.png"></p> <p><img src="/assets/img/Untitled32.02d5771c.png" alt="Untitled32.png"></p> <h2 id="_5-实战-分析elasticsearch查询语句"><a href="#_5-实战-分析elasticsearch查询语句" class="header-anchor">#</a> 5.实战：分析Elasticsearch查询语句</h2> <h3 id="_5-1-目标"><a href="#_5-1-目标" class="header-anchor">#</a> 5.1.目标</h3> <p>收集Elasticsearch集群的查询语句</p> <p>分析查询语句的常用语句、响应时长等</p> <h3 id="_5-2-方案"><a href="#_5-2-方案" class="header-anchor">#</a> 5.2.方案</h3> <p>应用Packetbeat + Logstash完成数据收集工作</p> <p>使用Kibana + Elasticsearch完成数据分析工作</p> <p><img src="/assets/img/Untitled33.1ec15c06.png" alt="Untitled33.png"></p> <h3 id="_5-3-环境配置"><a href="#_5-3-环境配置" class="header-anchor">#</a> 5.3.环境配置</h3> <p><img src="/assets/img/Untitled34.0d2fd972.png" alt="Untitled34.png"></p> <h3 id="_5-4-方案之logstach"><a href="#_5-4-方案之logstach" class="header-anchor">#</a> 5.4.方案之logstach</h3> <p><img src="/assets/img/Untitled35.2d923a3c.png" alt="Untitled35.png"></p> <h3 id="_5-5-方案之packetbeat"><a href="#_5-5-方案之packetbeat" class="header-anchor">#</a> 5.5.方案之packetbeat</h3> <p><img src="/assets/img/Untitled36.4dac6ffb.png" alt="Untitled36.png"></p> <h3 id="_5-6-kibana数据分析"><a href="#_5-6-kibana数据分析" class="header-anchor">#</a> 5.6.kibana数据分析</h3> <p><img src="/assets/img/Untitled37.f15cd5ba.png" alt="Untitled37.png"></p> <p><img src="/assets/img/Untitled38.11023ecd.png" alt="Untitled38.png"></p> <h2 id="_6-总结与建议"><a href="#_6-总结与建议" class="header-anchor">#</a> 6.总结与建议</h2> <p><img src="/assets/img/Untitled39.bfae4828.png" alt="Untitled39.png"></p> <p><img src="/assets/img/Untitled40.d52fc024.png" alt="Untitled40.png"></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/1/15 下午2:19:19</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/md/java/learn/learn-redis.html" class="prev">
        Redis
      </a></span> <span class="next"><a href="/md/java/learn/Dubbo学习笔记.html">
        Dubbo
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1f563e48.js" defer></script><script src="/assets/js/3.53f669bd.js" defer></script><script src="/assets/js/4.498eb10c.js" defer></script>
  </body>
</html>
